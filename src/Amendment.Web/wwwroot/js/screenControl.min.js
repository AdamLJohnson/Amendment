var ScreenControlModel=function(n){self.amendments=ko.observableArray(convertArrayToObservable([n]));self.amendment=ko.computed(function(){var n=arrayFirstIndexOf(self.amendments(),function(n){return n.isLive()});return n>-1?self.amendments()[n]:self.amendments()[0]});self.isLive=ko.computed(function(){var n=arrayFirstIndexOf(self.amendments(),function(n){return n.isLive()});return n>-1});self.primaryLanguageId=ko.computed(function(){var n=arrayFirstIndexOf(self.amendments(),function(n){return n.isLive()});return n>-1?self.amendments()[n].primaryLanguageId():-1});self.toggleAmendmentBody=function(n){n.isLive()?self.hub.invoke("amendmentBodyGoLive",n.amendId(),n.id(),!1):self.hub.invoke("amendmentBodyGoLive",n.amendId(),n.id(),!0)};self.changePage=function(n,t){var i=n==="next"?1:-1;self.hub.invoke("amendmentBodyChangePage",t.id(),i)};self.changeAllPages=function(n){var t=n==="next"?1:-1;self.hub.invoke("amendmentBodyChangeAllPages",amendment().id(),t)};self.resetAllPages=function(){self.hub.invoke("amendmentBodyResetAllPages",amendment().id())};self.togglePreview=function(){$(".preview").toggleClass("text-preview")};self.hub=ManageAmendmentHub();self.bodies=ko.computed(function(){var n,u;if(!self.amendment().amendmentBodies)return[];var i=[],t=[],r=self.amendment().amendmentBodies.sort(function(n,t){return n.languageId()===t.languageId()?0:n.languageId()<t.languageId()?-1:1});for(n=0;n<r().length;n++)u=r()[n],n%3==0&&(t=[],i.push(t)),t.push(u);return i});$(document).on("amendment.amendmentChange",function(n,t){var i=arrayFirstIndexOf(self.amendments(),function(n){return n.id()===t.id}),r,u;switch(t.results.operationType){case 1:self.amendments.push(convertToObservable(t.data));break;case 2:i>-1?(r=self.amendments()[i],u=convertToObservable(t.data),self.amendments.replace(r,u)):self.amendments.push(convertToObservable(t.data));break;case 3:self.amendments.remove(function(n){return n.id()===t.id})}});$(document).on("amendment.amendmentBodyChange",function(n,t){var u,r,i,f,e;if(console.log(t),u=t.data.amendId,i=arrayFirstIndexOf(self.amendments(),function(n){return n.id()===u}),i!==-1){r=self.amendments()[i];switch(t.results.operationType){case 1:r.amendmentBodies.push(convertToObservable(t.data));break;case 2:i=arrayFirstIndexOf(r.amendmentBodies(),function(n){return n.id()===t.id});i>-1&&(f=r.amendmentBodies()[i],e=convertToObservable(t.data),r.amendmentBodies.replace(f,e));break;case 3:r.amendmentBodies.remove(function(n){return n.id()===t.id})}}});testThis=self.bodies()};ko.applyBindings(new ScreenControlModel(initialData),document.getElementById("screenControl"));