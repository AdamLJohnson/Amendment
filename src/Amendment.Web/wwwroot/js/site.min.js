function ManageAmendmentHub(){function t(i){i&&console.log("Attempting reconnect");n.start().then(()=>{hideConnectionError(i),console.log("Connected"),i?jQuery.event.trigger("amendment.reconnect"):jQuery.event.trigger("amendment.ready")},n=>{console.log(n),setTimeout(()=>t(i),5e3)})}const n=(new signalR.HubConnectionBuilder).withUrl("/amendmentHub").build();n.on(_clientNotifierMethods.amendmentChange,n=>{toastr.options.escapeHtml=!0;var t="Amendment "+n.id,i="info";switch(n.results.operationType){case 1:t+=" created";break;case 2:t+=" updated";break;case 3:t+=" deleted";break;case 4:n.data.isLive?(i="error",t+=" changed to live"):(i="warning",t+=" changed to is not live");break;case 5:i="success";t+=" changed to page"}t+=" by "+n.user.name;_usersRoles.indexOf("Toast Notifications")>-1&&toastr[i](t,n.data.amendTitle);jQuery.event.trigger("amendment.amendmentChange",n)});n.on(_clientNotifierMethods.amendmentBodyChange,n=>{toastr.options.escapeHtml=!0;var t=n.data.language.languageName,i="info";switch(n.results.operationType){case 1:t+=" created";break;case 2:t+=" updated";break;case 3:t+=" deleted";break;case 4:n.data.isLive?(i="error",t+=" changed to live"):(i="warning",t+=" changed to is not live");break;case 5:i="success";t+=" changed to page "+(n.page+1)}t+=" by "+n.user.name;_usersRoles.indexOf("Toast Notifications")>-1&&toastr[i](t,n.amendment.amendTitle);jQuery.event.trigger("amendment.amendmentBodyChange",n)});n.onclose(()=>{showConnectionError(),t(!0)});return t(!1),testconn=n,n}function ScreenViewHub(n){function i(r){r&&console.log("Attempting reconnect");t.start().then(()=>{hideConnectionError(r),console.log("Connected"),r?jQuery.event.trigger("screen.reconnect."+n):jQuery.event.trigger("screen.ready."+n)},n=>{console.log(n),setTimeout(()=>i(r),5e3)})}const t=(new signalR.HubConnectionBuilder).withUrl("/screenHub?languageId="+n).build();t.on(_clientNotifierMethods.clearScreens,()=>{jQuery.event.trigger("screen.clearScreens."+n)});t.on(_clientNotifierMethods.amendmentBodyChange,t=>{jQuery.event.trigger("screen.amendmentBodyChange."+n,t)});t.on(_clientNotifierMethods.amendmentChange,t=>{jQuery.event.trigger("screen.amendmentChange."+n,t)});t.on(_clientNotifierMethods.refreshLanguage,t=>{jQuery.event.trigger("screen.refreshLanguage."+n,t)});t.onclose(()=>{showConnectionError(),i(!0)});return i(!1),t}function initScreenViewModel(n,t,i,r,u){var f=function(){var n=this;n.hub=ScreenViewHub(t);n.amendmentIsLive=ko.observable(i.isLive);n.amendmentBodyIsLive=ko.observable(r.isLive);n.amendBodyPagedHtml=ko.observable(r.amendBodyPagedHtml);n.page=ko.observable(r.page);n.pages=ko.observable(r.pages);n.language=u;n.languageId=t;n.ShowDeafSigner=ko.observable("0");n.ShowDeafSignerBox=ko.observable("0");n.isLive=ko.computed(function(){return n.amendmentIsLive()&&n.amendmentBodyIsLive()});$(document).on("screen.amendmentBodyChange."+n.languageId,function(t,i){n.amendBodyPagedHtml(i.amendBodyPagedHtml);n.amendmentBodyIsLive(i.isLive);n.page(i.page);n.pages(i.pages)});$(document).on("screen.amendmentChange."+n.languageId,function(t,i){n.amendmentIsLive(i.isLive)});$(document).on("screen.clearScreens."+n.languageId,function(){n.amendmentIsLive(!1);n.amendmentBodyIsLive(!1)});$(document).on("screen.refreshLanguage."+n.languageId,function(t,i){i.amendmentBody?(n.amendBodyPagedHtml(i.amendmentBody.amendBodyPagedHtml),n.amendmentBodyIsLive(i.amendmentBody.isLive),n.page(i.amendmentBody.page),n.pages(i.amendmentBody.pages)):n.amendmentBodyIsLive(!1);n.amendmentIsLive(i.amendment.isLive)});$(document).on("screen.reconnect."+t,function(){console.log("screen.reconnect."+n.languageId);n.hub.invoke("refreshLanguage",t);n.hub.invoke("getSystemSetting","ShowDeafSigner");n.hub.invoke("getSystemSetting","ShowDeafSignerBox")});$(document).on("screen.ready."+t,function(){n.hub.invoke("getSystemSetting","ShowDeafSigner");n.hub.invoke("getSystemSetting","ShowDeafSignerBox")});n.hub.on("RefreshSetting",function(t){updateSetting(n,t)})};ko.applyBindings(new f,document.getElementById(n))}function convertArrayToObservable(n){var t=[];return $.each(n,function(n,i){var r=convertToObservable(i);t.push(r)}),t}function convertToObservable(n){var t={};if(typeof n=="object"&&n!==null)Object.keys(n).forEach(function(i){t[i]=Array.isArray(n[i])?ko.observableArray(convertArrayToObservable(n[i])):ko.observable(n[i])});else return ko.observable(n);return t}function arrayFirstIndexOf(n,t,i){for(var r=0,u=n.length;r<u;r++)if(t.call(i,n[r]))return r;return-1}function userIsInRole(){var n,t;if(arguments.length===0)return!1;for(n=0;n<arguments.length;n++)if(t=_usersRoles.indexOf(arguments[n]),t>-1)return!0;return!1}function showConnectionError(){$("#connection-error").removeClass("hidden");$(".fullscreen .connection-error").removeClass("hidden");jQuery.event.trigger("connection.error")}function hideConnectionError(n){$("#connection-error").addClass("hidden");$(".fullscreen .connection-error").addClass("hidden");n&&jQuery.event.trigger("connection.reconnect")}function updateSetting(n,t){n[t.key]?n[t.key](t.value):n[t.key]=ko.observable(t.value)}toastr.options={newestOnTop:!0,progressBar:!0};