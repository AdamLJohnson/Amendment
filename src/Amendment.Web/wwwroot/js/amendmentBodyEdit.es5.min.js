"use strict";function newFunction(n,t){var i,r,u;n.id===amendmentId&&(i=arrayFirstIndexOf(t.amendments(),function(t){return t.id()===n.id}),i>-1?(r=t.amendments()[i],u=convertToObservable(n),t.amendments.replace(r,u)):t.amendments.push(convertToObservable(n)))}var AmendmentModel=function(n){var r=ManageAmendmentHub(),t=this,i;t.amendments=ko.observableArray();t.amendBody=ko.observable(n.amendBody);t.page=ko.observable(-1);t.amendBodyPages=ko.computed(function(){return t.amendBody()?{amendBodyPages:t.amendBody().split("**NEWSLIDE**").map(function(n){return marked(n,{breaks:!0})})}:{amendBodyPages:[""]}});r.on("amendment.amendmentReturn",function(n){newFunction(n,t)});$(document).on("amendment.amendmentChange",function(n,i){newFunction(i.data,t)});$(document).on("amendment.ready",function(){r.invoke("getAmendment",amendmentId)});$(document).on("amendment.amendmentBodyChange",function(n,i){var e,u,r,f,o,s;if(console.log(i),e=i.data.amendId,u=arrayFirstIndexOf(t.amendments(),function(n){return n.id()===e}),u!==-1){r=t.amendments()[u];switch(i.results.operationType){case 1:r.amendmentBodies.push(convertToObservable(i.data));break;case 2:f=arrayFirstIndexOf(r.amendmentBodies(),function(n){return n.id()===i.id});f>-1&&(o=r.amendmentBodies()[f],s=convertToObservable(i.data),r.amendmentBodies.replace(o,s));break;case 3:r.amendmentBodies.remove(function(n){return n.id()===i.id})}}});if(i=$(".markdown-editor"),i.length>0){t.editor=new SimpleMDE({element:i[0],forceSync:!0,spellChecker:!1,hideIcons:["guide","preview","side-by-side","fullscreen"]});t.editor.codemirror.on("change",function(){t.amendBody($("#AmendBody").val())})}$("#insertPage").click(function(){var n=t.editor.codemirror.getCursor();t.editor.codemirror.setSelection(n,n);t.editor.codemirror.replaceSelection("**NEWSLIDE**")})};ko.applyBindings(new AmendmentModel(initialData));