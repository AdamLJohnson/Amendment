"use strict";var AmendmentModel=function(n){var i=ManageAmendmentHub(),t=this;t.hub=i;t.search_field=ko.observable("");t.clearSearch=function(){t.search_field("")};t.checkForEscapeKey=function(n,i){return i.key==="Escape"&&t.clearSearch(),!0};t.amendments=ko.observableArray(convertArrayToObservable(n));t.filteredAmendmentIds=ko.computed(function(){var n=t.search_field();return n.length===0?t.amendments().map(function(n){return n.id()}):ko.utils.arrayFilter(t.amendments(),function(t){return(n=n.toLowerCase(),t.motion()&&t.motion().toLowerCase().indexOf(n)>-1)?!0:t.author()&&t.author().toLowerCase().indexOf(n)>-1?!0:t.amendTitle()&&t.amendTitle().toLowerCase().indexOf(n)>-1?!0:t.legisId()&&t.legisId().toLowerCase().indexOf(n)>-1?!0:!1}).map(function(n){return n.id()})});t.userRoles=_usersRoles;t.liveAmendment=ko.computed(function(){var n=arrayFirstIndexOf(t.amendments(),function(n){return n.isLive()});return n>-1?t.amendments()[n].id():-1});t.languageData=languageData;t.clearScreens=function(){i.invoke("clearScreens")};t.amendmentGoLive=function(n){i.invoke("amendmentGoLive",n.id(),!0)};$(document).on("amendment.amendmentChange",function(n,i){var r,u,f;switch(i.results.operationType){case 1:t.amendments.push(convertToObservable(i.data));break;case 2:case 4:case 5:r=arrayFirstIndexOf(t.amendments(),function(n){return n.id()===i.id});r>-1&&(u=t.amendments()[r],f=convertToObservable(i.data),t.amendments.replace(u,f));break;case 3:t.amendments.remove(function(n){return n.id()===i.id})}});$(document).on("amendment.amendmentBodyChange",function(n,i){var s=i.data.amendId,f=arrayFirstIndexOf(t.amendments(),function(n){return n.id()===s}),r,u,e,o;if(f!==-1){r=t.amendments()[f];switch(i.results.operationType){case 1:r.amendmentBodies.push(convertToObservable(i.data));break;case 2:case 4:case 5:u=arrayFirstIndexOf(r.amendmentBodies(),function(n){return n.id()===i.id});u>-1&&(e=r.amendmentBodies()[u],o=convertToObservable(i.data),r.amendmentBodies.replace(e,o));break;case 3:r.amendmentBodies.remove(function(n){return n.id()===i.id})}}});$(document).keyup(function(n){t.checkForEscapeKey(null,n)});$(document).on("amendment.reconnect",function(){t.hub.invoke("GetAllAmendments")});t.hub.on("amendment.getAllAmendmentsReturn",function(n){t.amendments(convertArrayToObservable(n))})};ko.applyBindings(new AmendmentModel(initialData),document.getElementById("amendmentList"));