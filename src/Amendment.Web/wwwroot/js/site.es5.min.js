"use strict";function ManageAmendmentHub(){function t(i){var r;return regeneratorRuntime.async(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,i&&console.log("Attempting reconnect"),u.next=4,regeneratorRuntime.awrap(n.start());case 4:r=u.sent;r.then(function(){jQuery.event.trigger("amendment.ready")});hideConnectionError(i);console.log("Connected");u.next=14;break;case 10:u.prev=10;u.t0=u["catch"](0);console.log(u.t0);setTimeout(function(){return t(i)},5e3);case 14:case"end":return u.stop()}},null,this,[[0,10]])}var i=this,n=(new signalR.HubConnectionBuilder).withUrl("/amendmentHub").build();n.on(_clientNotifierMethods.amendmentChange,function(n){toastr.options.escapeHtml=!0;var t="Amendment "+n.id;switch(n.results.operationType){case 1:t+=" Created";break;case 2:t+=" Updated";break;case 3:t+=" Deleted"}toastr.info(t);jQuery.event.trigger("amendment.amendmentChange",n)});n.on(_clientNotifierMethods.amendmentBodyChange,function(n){toastr.options.escapeHtml=!0;var t="Amendment Body "+n.id;switch(n.results.operationType){case 1:t+=" Created";break;case 2:t+=" Updated";break;case 3:t+=" Deleted"}toastr.info(t);jQuery.event.trigger("amendment.amendmentBodyChange",n)});n.onclose(function(){return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return showConnectionError(),n.next=3,regeneratorRuntime.awrap(t(!0));case 3:case"end":return n.stop()}},null,i)});return t(!1),testconn=n,n}function ScreenViewHub(n){var t=(new signalR.HubConnectionBuilder).withUrl("/screenHub?languageId="+n).build();t.on(_clientNotifierMethods.clearScreens,function(){if(_usersRoles.indexOf("System Administrator")>-1){toastr.options.escapeHtml=!0;toastr.info("",_clientNotifierMethods.clearScreens)}jQuery.event.trigger("screen.clearScreens."+n)});t.on(_clientNotifierMethods.amendmentBodyChange,function(t){if(_usersRoles.indexOf("System Administrator")>-1){toastr.options.escapeHtml=!0;var i="screen "+t.id;toastr.info(i,_clientNotifierMethods.amendmentBodyChange)}jQuery.event.trigger("screen.amendmentBodyChange."+n,t)});t.on(_clientNotifierMethods.amendmentChange,function(t){if(_usersRoles.indexOf("System Administrator")>-1){toastr.options.escapeHtml=!0;var i="screen "+t.id;toastr.info(i,_clientNotifierMethods.amendmentChange)}jQuery.event.trigger("screen.amendmentChange."+n,t)});t.onclose(function(){showConnectionError()});return t.start()["catch"](function(n){return console.error(n.toString())}),t}function initScreenViewModel(n,t,i,r,u){var f=function(){var n=this;n.hub=ScreenViewHub(t);n.amendmentIsLive=ko.observable(i.isLive);n.amendmentBodyIsLive=ko.observable(r.isLive);n.amendBodyPagedHtml=ko.observable(r.amendBodyPagedHtml);n.page=ko.observable(r.page);n.pages=ko.observable(r.pages);n.language=u;n.languageId=t;n.isLive=ko.computed(function(){return n.amendmentIsLive()&&n.amendmentBodyIsLive()});$(document).on("screen.amendmentBodyChange."+n.languageId,function(t,i){n.amendBodyPagedHtml(i.amendBodyPagedHtml);n.amendmentBodyIsLive(i.isLive);n.page(i.page);n.pages(i.pages)});$(document).on("screen.amendmentChange."+n.languageId,function(t,i){n.amendmentIsLive(i.isLive)});$(document).on("screen.clearScreens."+n.languageId,function(){n.amendmentIsLive(!1);n.amendmentBodyIsLive(!1)})};ko.applyBindings(new f,document.getElementById(n))}function convertArrayToObservable(n){var t=[];return $.each(n,function(n,i){var r=convertToObservable(i);t.push(r)}),t}function convertToObservable(n){var t={};if(typeof n=="object"&&n!==null)Object.keys(n).forEach(function(i){t[i]=Array.isArray(n[i])?ko.observableArray(convertArrayToObservable(n[i])):ko.observable(n[i])});else return ko.observable(n);return t}function arrayFirstIndexOf(n,t,i){for(var r=0,u=n.length;r<u;r++)if(t.call(i,n[r]))return r;return-1}function userIsInRole(){var n,t;if(arguments.length===0)return!1;for(n=0;n<arguments.length;n++)if(t=_usersRoles.indexOf(arguments[n]),t>-1)return!0;return!1}function showConnectionError(){$("#connection-error").removeClass("hidden");jQuery.event.trigger("connection.error")}function hideConnectionError(n){$("#connection-error").addClass("hidden");n&&jQuery.event.trigger("connection.reconnect")}