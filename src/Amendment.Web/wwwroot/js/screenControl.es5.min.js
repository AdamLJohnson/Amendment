"use strict";var ScreenControlModel=function(n){function t(n){var t=arrayFirstIndexOf(self.amendments(),function(t){return t.id()===n.id}),i,r;switch(n.results.operationType){case 1:self.amendments.push(convertToObservable(n.data));break;case 2:case 4:case 5:t>-1?(i=self.amendments()[t],r=convertToObservable(n.data),self.amendments.replace(i,r)):self.amendments.push(convertToObservable(n.data));break;case 3:self.amendments.remove(function(t){return t.id()===n.id})}}self.amendments=ko.observableArray(convertArrayToObservable([n]));self.ShowDeafSigner=ko.observable("0");self.ShowDeafSignerBox=ko.observable("0");self.amendment=ko.computed(function(){var n=arrayFirstIndexOf(self.amendments(),function(n){return n.isLive()});return n>-1?self.amendments()[n]:self.amendments()[0]});self.isLive=ko.computed(function(){var n=arrayFirstIndexOf(self.amendments(),function(n){return n.isLive()});return n>-1});self.primaryLanguageId=ko.computed(function(){var n=arrayFirstIndexOf(self.amendments(),function(n){return n.isLive()});return n>-1?self.amendments()[n].primaryLanguageId():-1});self.toggleAmendmentBody=function(n){n.isLive()?self.hub.invoke("amendmentBodyGoLive",n.amendId(),n.id(),!1):self.hub.invoke("amendmentBodyGoLive",n.amendId(),n.id(),!0)};self.changePage=function(n,t){var i=n==="next"?1:-1;self.hub.invoke("amendmentBodyChangePage",t.id(),i)};self.changeAllPages=function(n){var t=n==="next"?1:-1;self.hub.invoke("amendmentBodyChangeAllPages",amendment().id(),t)};self.resetAllPages=function(){self.hub.invoke("amendmentBodyResetAllPages",amendment().id())};self.previewEnabled=ko.observable(!0);self.togglePreview=function(){self.previewEnabled(!self.previewEnabled())};self.hub=ManageAmendmentHub();self.bodies=ko.computed(function(){var n,u;if(!self.amendment().amendmentBodies)return[];var i=[],t=[],r=self.amendment().amendmentBodies.sort(function(n,t){return n.languageId()===t.languageId()?0:n.languageId()<t.languageId()?-1:1});for(n=0;n<r().length;n++)u=r()[n],n%3==0&&(t=[],i.push(t)),t.push(u);return i});self.anyBodiesLive=ko.computed(function(){var n=arrayFirstIndexOf(self.amendment().amendmentBodies(),function(n){return n.isLive()});return n!==-1});self.toggleAmendmentBodyAll=function(){for(var t,n=0;n<self.amendment().amendmentBodies().length;n++)t=self.amendment().amendmentBodies()[n],t.isLive()===self.anyBodiesLive()&&self.hub.invoke("amendmentBodyGoLive",t.amendId(),t.id(),!self.anyBodiesLive())};$(document).on("amendment.reconnect",function(){self.hub.invoke("getLiveAmendment");self.hub.invoke("getSystemSetting","ShowDeafSigner");self.hub.invoke("getSystemSetting","ShowDeafSignerBox")});$(document).on("amendment.ready",function(){self.hub.invoke("getSystemSetting","ShowDeafSigner");self.hub.invoke("getSystemSetting","ShowDeafSignerBox")});self.hub.on("RefreshSetting",function(n){updateSetting(self,n)});self.hub.on("amendment.getLiveAmendmentReturn",function(n){self.amendments(convertArrayToObservable([n]))});$(document).on("amendment.amendmentChange",function(n,i){t(i)});$(document).on("amendment.amendmentBodyChange",function(n,t){var o=t.data.amendId,u=arrayFirstIndexOf(self.amendments(),function(n){return n.id()===o}),i,r,f,e;if(u!==-1){i=self.amendments()[u];switch(t.results.operationType){case 1:i.amendmentBodies.push(convertToObservable(t.data));break;case 2:case 4:case 5:r=arrayFirstIndexOf(i.amendmentBodies(),function(n){return n.id()===t.id});r>-1&&(f=i.amendmentBodies()[r],e=convertToObservable(t.data),i.amendmentBodies.replace(f,e));break;case 3:i.amendmentBodies.remove(function(n){return n.id()===t.id})}}})};ko.applyBindings(new ScreenControlModel(initialData),document.getElementById("screenControl"));